"use strict";(self.webpackChunkhhkt_docs_tkpm=self.webpackChunkhhkt_docs_tkpm||[]).push([[6020],{7294:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"developer-guide/inversion-of-control-and-dependency-injection","title":"Inversion of Control and Dependency Injection","description":"Introduction","source":"@site/docs/developer-guide/inversion-of-control-and-dependency-injection.md","sourceDirName":"developer-guide","slug":"/developer-guide/inversion-of-control-and-dependency-injection","permalink":"/en/docs/developer-guide/inversion-of-control-and-dependency-injection","draft":false,"unlisted":false,"editUrl":"https://github.com/hhkt-tkpm/hhkt-tkpm.github.io/tree/main/docs/developer-guide/inversion-of-control-and-dependency-injection.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Backend Architecture Overview","permalink":"/en/docs/developer-guide/backend-architecture-overview"},"next":{"title":"Data Validation","permalink":"/en/docs/developer-guide/data-validation"}}');var t=r(4848),o=r(8453);const s={sidebar_position:3},a="Inversion of Control and Dependency Injection",l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Inversion of Control (IoC) Overview",id:"inversion-of-control-ioc-overview",level:2},{value:"What is IoC?",id:"what-is-ioc",level:3},{value:"Spring IoC Container in Our System",id:"spring-ioc-container-in-our-system",level:3},{value:"Dependency Injection Patterns",id:"dependency-injection-patterns",level:2},{value:"1. Constructor Injection (Primary Pattern)",id:"1-constructor-injection-primary-pattern",level:3},{value:"2. Field Injection (Framework Constraints Only)",id:"2-field-injection-framework-constraints-only",level:3},{value:"Component Architecture and Annotations",id:"component-architecture-and-annotations",level:2},{value:"Spring Stereotype Annotations in Our System",id:"spring-stereotype-annotations-in-our-system",level:3},{value:"Real Component Dependencies",id:"real-component-dependencies",level:3},{value:"Interface-Based Design Pattern",id:"interface-based-design-pattern",level:3},{value:"Repository Auto-Implementation",id:"repository-auto-implementation",level:2},{value:"Spring Data JPA Magic",id:"spring-data-jpa-magic",level:3},{value:"Custom Component Injection",id:"custom-component-injection",level:2},{value:"Validator Components",id:"validator-components",level:3},{value:"Filter Components",id:"filter-components",level:3},{value:"Configuration and Bean Definition",id:"configuration-and-bean-definition",level:2},{value:"Application Configuration",id:"application-configuration",level:3},{value:"Bean Scopes",id:"bean-scopes",level:3},{value:"Testing with Dependency Injection",id:"testing-with-dependency-injection",level:2},{value:"Unit Testing with Mocks",id:"unit-testing-with-mocks",level:3},{value:"Integration Testing",id:"integration-testing",level:3}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"inversion-of-control-and-dependency-injection",children:"Inversion of Control and Dependency Injection"})}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"Inversion of Control (IoC) and Dependency Injection (DI) are core principles of the Spring Framework that enable loose coupling and testable code architecture. This document explains how IoC and DI are implemented in our Student Management System, focusing on practical patterns and real implementations from the codebase."}),"\n",(0,t.jsx)(n.h2,{id:"inversion-of-control-ioc-overview",children:"Inversion of Control (IoC) Overview"}),"\n",(0,t.jsx)(n.h3,{id:"what-is-ioc",children:"What is IoC?"}),"\n",(0,t.jsx)(n.p,{children:"IoC is a design principle where the control of object creation and lifecycle management is transferred from the application code to an external container (Spring IoC Container)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Traditional Approach (Without IoC):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public class ProgramController {\n    private IProgramService programService;\n    \n    public ProgramController() {\n        this.programService = new ProgramServiceImpl(); // Tight coupling\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"IoC Approach (Our Implementation):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@RestController\n@RequiredArgsConstructor\npublic class ProgramController {\n    private final IProgramService programService; // Container provides implementation\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"spring-ioc-container-in-our-system",children:"Spring IoC Container in Our System"}),"\n",(0,t.jsx)(n.p,{children:"The Spring container manages all components in our Student Management System:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Spring IoC Container\n\u251c\u2500\u2500 Controllers (ProgramController, StudentController, etc.)\n\u251c\u2500\u2500 Services (ProgramServiceImpl, StudentServiceImpl, etc.)\n\u251c\u2500\u2500 Repositories (IProgramRepository, IStudentRepository, etc.)\n\u251c\u2500\u2500 Validators (EmailDomainValidator, PhoneNumberValidator, etc.)\n\u2514\u2500\u2500 Filters (TranslationFilter)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"dependency-injection-patterns",children:"Dependency Injection Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"1-constructor-injection-primary-pattern",children:"1. Constructor Injection (Primary Pattern)"}),"\n",(0,t.jsx)(n.p,{children:"Our system exclusively uses constructor injection for all controllers and services, ensuring immutable dependencies and fail-fast behavior."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Implementation with Lombok:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@RestController\n@RequestMapping("/api/programs")\n@RequiredArgsConstructor  // Lombok generates constructor\n@Slf4j\npublic class ProgramController {\n    private final IProgramService programService;\n    \n    @PostMapping("")\n    public APIResponse addProgram(@RequestBody @Valid ProgramRequest request) {\n        ProgramResponse program = programService.addProgram(request);\n        return APIResponse.builder()\n                .status(HttpStatus.CREATED.value())\n                .message("Success")\n                .data(program)\n                .build();\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Service Layer Implementation:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Service\n@RequiredArgsConstructor\n@Slf4j\npublic class ProgramServiceImpl implements IProgramService {\n    private final IProgramRepository programRepository;\n    \n    @Override\n    public ProgramResponse addProgram(ProgramRequest request) {\n        if (programRepository.findByProgramName(request.getProgramName()).isPresent()) {\n            throw new RuntimeException("Program already exists");\n        }\n        // Business logic implementation\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Why Constructor Injection:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Immutability:"})," Dependencies cannot be changed after object creation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Required Dependencies:"})," Ensures all dependencies are provided at creation time"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Testability:"})," Easy to mock dependencies in unit tests"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Thread Safety:"})," Immutable fields are inherently thread-safe"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-field-injection-framework-constraints-only",children:"2. Field Injection (Framework Constraints Only)"}),"\n",(0,t.jsx)(n.p,{children:"Used only when framework constraints prevent constructor injection:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"TranslationFilter Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\n@Order(1)\n@Slf4j\npublic class TranslationFilter implements Filter {\n    \n    @Autowired\n    private TranslationService translationService;\n    \n    @Autowired\n    private ObjectMapper objectMapper;\n    \n    // Servlet Filter requires no-arg constructor\n    // Framework instantiates with default constructor\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"EmailDomainValidator Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class EmailDomainValidator implements ConstraintValidator<EmailDomain, String> {\n\n    private final IEmailDomainRepository emailDomainRepository;\n\n    @Autowired  // Required for Bean Validation framework\n    public EmailDomainValidator(IEmailDomainRepository emailDomainRepository) {\n        this.emailDomainRepository = emailDomainRepository;\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"component-architecture-and-annotations",children:"Component Architecture and Annotations"}),"\n",(0,t.jsx)(n.h3,{id:"spring-stereotype-annotations-in-our-system",children:"Spring Stereotype Annotations in Our System"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Component Type"}),(0,t.jsx)(n.th,{children:"Annotation"}),(0,t.jsx)(n.th,{children:"Purpose"}),(0,t.jsx)(n.th,{children:"Examples from Our Code"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Controllers"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@RestController"})}),(0,t.jsx)(n.td,{children:"HTTP request handling"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ProgramController"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Business Logic"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@Service"})}),(0,t.jsx)(n.td,{children:"Service layer implementation"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ProgramServiceImpl"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Data Access"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@Repository"})}),(0,t.jsx)(n.td,{children:"Data access abstraction"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"IProgramRepository"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"General Components"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@Component"})}),(0,t.jsx)(n.td,{children:"Generic Spring beans"}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"TranslationFilter"}),", ",(0,t.jsx)(n.code,{children:"EmailDomainValidator"})]})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"real-component-dependencies",children:"Real Component Dependencies"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"ProgramController Dependency Chain:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ProgramController\n     \u2193 (depends on)\nIProgramService\n     \u2193 (implemented by)\nProgramServiceImpl\n     \u2193 (depends on)  \nIProgramRepository\n     \u2193 (auto-implemented by Spring Data JPA)\nProgramRepositoryImpl (Generated)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"interface-based-design-pattern",children:"Interface-Based Design Pattern"}),"\n",(0,t.jsx)(n.p,{children:"Our system follows interface-based dependency injection for loose coupling:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Service Interface:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public interface IProgramService {\n    ProgramResponse addProgram(ProgramRequest request);\n    List<ProgramResponse> getAllPrograms();\n    ProgramResponse getProgramById(Integer id);\n    ProgramResponse updateProgram(Integer id, ProgramRequest request);\n    void deleteProgram(Integer id);\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Abstraction:"})," Controllers depend on interfaces, not implementations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Testability:"})," Easy to create mock implementations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Flexibility:"})," Can swap implementations without changing controllers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Maintainability:"})," Clear contracts between layers"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"repository-auto-implementation",children:"Repository Auto-Implementation"}),"\n",(0,t.jsx)(n.h3,{id:"spring-data-jpa-magic",children:"Spring Data JPA Magic"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Repository\npublic interface IProgramRepository extends JpaRepository<Program, Integer> {\n    Optional<Program> findByProgramName(String programName);\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What Spring Does Automatically:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Proxy Creation:"})," Generates implementation at runtime"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Method Implementation:"})," Creates SQL queries from method names"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transaction Management:"})," Handles database transactions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Exception Translation:"})," Converts database exceptions to Spring exceptions"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Custom Query Methods:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"findByProgramName"})," \u2192 ",(0,t.jsx)(n.code,{children:"SELECT * FROM programs WHERE program_name = ?"})]}),"\n",(0,t.jsx)(n.li,{children:"Spring generates implementation based on method naming conventions"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"custom-component-injection",children:"Custom Component Injection"}),"\n",(0,t.jsx)(n.h3,{id:"validator-components",children:"Validator Components"}),"\n",(0,t.jsx)(n.p,{children:"Custom validators demonstrate DI in specialized components:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class EmailDomainValidator implements ConstraintValidator<EmailDomain, String> {\n\n    private final IEmailDomainRepository emailDomainRepository;\n\n    @Autowired\n    public EmailDomainValidator(IEmailDomainRepository emailDomainRepository) {\n        this.emailDomainRepository = emailDomainRepository;\n    }\n    \n    @Override\n    public boolean isValid(String email, ConstraintValidatorContext context) {\n        // Validation logic using injected repository\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"filter-components",children:"Filter Components"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\n@Order(1)\n@Slf4j\npublic class TranslationFilter implements Filter {\n\n    public static final ThreadLocal<String> CURRENT_LANGUAGE = new ThreadLocal<>();\n    public static final String DEFAULT_LANGUAGE = "vi";\n\n    @Autowired\n    private TranslationService translationService;\n    @Autowired\n    private ObjectMapper objectMapper;\n\n    @Override\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\n            throws IOException, ServletException {\n\n        HttpServletRequest httpRequest = (HttpServletRequest) request;\n        HttpServletResponse httpResponse = (HttpServletResponse) response;\n\n        // And so on with filter logic...\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"configuration-and-bean-definition",children:"Configuration and Bean Definition"}),"\n",(0,t.jsx)(n.h3,{id:"application-configuration",children:"Application Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class WebConfig implements WebMvcConfigurer {\n\n    @Bean\n    public FilterRegistrationBean<TranslationFilter> translationFilterRegistration(\n            TranslationFilter translationFilter) {\n        FilterRegistrationBean<TranslationFilter> registration = new FilterRegistrationBean<>();\n        registration.setFilter(translationFilter);\n        registration.addUrlPatterns("/*");\n        registration.setOrder(1);\n        return registration;\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"bean-scopes",children:"Bean Scopes"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Scope"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"Usage in Our System"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"@Singleton"})," (default)"]}),(0,t.jsx)(n.td,{children:"One instance per container"}),(0,t.jsx)(n.td,{children:"Services, Repositories"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@Prototype"})}),(0,t.jsx)(n.td,{children:"New instance per request"}),(0,t.jsx)(n.td,{children:"Not commonly used"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@Request"})}),(0,t.jsx)(n.td,{children:"One instance per HTTP request"}),(0,t.jsx)(n.td,{children:"Not used in our stateless API"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"@Session"})}),(0,t.jsx)(n.td,{children:"One instance per HTTP session"}),(0,t.jsx)(n.td,{children:"Not applicable"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"testing-with-dependency-injection",children:"Testing with Dependency Injection"}),"\n",(0,t.jsx)(n.h3,{id:"unit-testing-with-mocks",children:"Unit Testing with Mocks"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@ExtendWith(MockitoExtension.class)\npublic class ProgramServiceTest {\n    @Mock\n    private IProgramRepository programRepository;\n\n    @InjectMocks\n    private ProgramServiceImpl programService;\n\n    @Test\n    public void shouldGetProgramById() {\n        Program program = new Program(1, "Computer Science");\n\n        when(programRepository.findById(1)).thenReturn(Optional.of(program));\n\n        ProgramResponse programResponse = programService.getProgramById(1);\n\n        assertThat(programResponse.getId()).isEqualTo(1);\n        assertThat(programResponse.getProgramName()).isEqualTo("Computer Science");\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"integration-testing",children:"Integration Testing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@WebMvcTest(ProgramController.class)\n@MockBean(JpaMetamodelMappingContext.class)\n@Import(TestConfig.class)\npublic class ProgramControllerTest {\n    @Autowired\n    private MockMvc mockMvc;\n\n    @MockBean\n    private ProgramServiceImpl programService;\n\n    @Test\n    public void shouldGetProgramById() throws Exception {\n        ProgramResponse program = ProgramResponse.builder().id(1).programName("Computer Science").build();\n\n        when(programService.getProgramById(1)).thenReturn(program);\n\n        mockMvc.perform(get("/api/programs/1"))\n                .andExpect(jsonPath("$.status").value(HttpStatus.OK.value()))\n                .andExpect(jsonPath("$.data.id").value(1))\n                .andExpect(jsonPath("$.data.programName").value("Computer Science"));\n    }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"This guide provides comprehensive coverage of dependency injection patterns used in the Student Management System. For practical implementation examples, refer to the source code in the respective packages."})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var i=r(6540);const t={},o=i.createContext(t);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);